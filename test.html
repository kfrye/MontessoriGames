<!DOCTYPE html>
<html>
<head>
    <script type="text/javascript" src="http://code.createjs.com/createjs-2013.12.12.min.js"></script>
    <script>
        var stage;
        var rCircle = new Array();
        var lCircle = new Array();
        var num = 2;

        function Button(color, sound) {
            this.shape = new createjs.Shape();
            this.color = color;
            this.sound = "note"+(sound+1);
        }

        var lastSound = {
            color: "start",
            sound: 0
        };

        function init() {
            if (!createjs.Sound.initializeDefaultPlugins()) {return;}

            var audioPath = "res/";
            var manifest = [
                {id:"note1", src:"note1.mp3"},
                {id:"note2", src:"note2.mp3"}
            ];
            var redArray = new Array();
            var blueArray = new Array();

            createjs.Sound.addEventListener("fileload", handleLoad);
            createjs.Sound.registerManifest(manifest, audioPath);
            stage = new createjs.Stage("demoCanvas");

            // initialize the arrays
            for(var i=0; i<num; i++) {
                redArray[i] = i;
                blueArray[i] = i;
            }

            Shuffle(redArray);
            Shuffle(blueArray);

            for(i=0; i < num; i++) {
                rCircle[i] = new Button("red", redArray[i]);
                lCircle[i] = new Button("blue", blueArray[i]);
                drawCircle(lCircle[i], i);
                drawCircle(rCircle[i], i);
            }
        }

        function drawCircle(circle, index) {

            console.log(circle.color+" "+index);
            circle.shape.graphics.beginFill(circle.color).drawCircle(0, 0, 50);

            if(circle.color == "red") {
                circle.shape.x = 100;
            }
            else {
                circle.shape.x = 250;
            }
            circle.shape.y = (index + 1) * 150 - 50;
            circle.shape.on("click", handleClick, null, false, [circle.color, circle.sound] );

            stage.addChild(circle.shape);
            stage.update();
        }

        function handleLoad(event) {
        }

        function handleClick(event, data) {
            var color = data[0];
            var sound = data[1];
            console.log(color+" "+sound);

            if(color != lastSound["color"]) {
                if(sound === lastSound["sound"]) {
                    console.log("Successful match!");
                }
            }
            createjs.Sound.play(sound);
            lastSound["color"] = color;
            lastSound["sound"] = sound;
        }

        function handleClick2(event) {
            console.log(sound);
            if(sound == "note2") {
                circle2.graphics.beginFill("green").drawCircle(0, 0, 50);
            }
            else {
                circle2.graphics.beginFill("blue").drawCircle(0, 0, 50);
            }
            createjs.Sound.play("note2");
            sound = "note2";
            stage.update();
        }

        function Shuffle(o) {
            for(var j, x, i = o.length; i; j = parseInt(Math.random() * i), x = o[--i], o[i] = o[j], o[j] = x);
            return o;
        }

    </script>
</head>
<body onLoad="init();">
<canvas id="demoCanvas" width="500" height="300">
    alternate content
</canvas>
</body>
</html>